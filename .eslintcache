[{"C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\index.tsx":"1","C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\App.tsx":"2","C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\context.ts":"3","C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\test.object.assign.ts":"4","C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\ImageStream.tsx":"5","C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\Sidebar.tsx":"6","C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\model\\ImageFromFilter.ts":"7","C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\model\\Image.ts":"8","C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\GalleryInScroll.tsx":"9","C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\MyPhoto.tsx":"10","C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\my-gallery.tsx":"11","C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\widgets\\header.tsx":"12","C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\browse\\browse-page.tsx":"13","C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\browse\\check-md5.tsx":"14"},{"size":232,"mtime":1611940295847,"results":"15","hashOfConfig":"16"},{"size":2393,"mtime":1612210216172,"results":"17","hashOfConfig":"16"},{"size":1074,"mtime":1612132311656,"results":"18","hashOfConfig":"16"},{"size":215,"mtime":1611940295898,"results":"19","hashOfConfig":"16"},{"size":4194,"mtime":1612132496552,"results":"20","hashOfConfig":"16"},{"size":1283,"mtime":1611952090388,"results":"21","hashOfConfig":"16"},{"size":354,"mtime":1611951917523,"results":"22","hashOfConfig":"16"},{"size":3860,"mtime":1611951888613,"results":"23","hashOfConfig":"16"},{"size":2214,"mtime":1611950367369,"results":"24","hashOfConfig":"16"},{"size":1653,"mtime":1612132289704,"results":"25","hashOfConfig":"16"},{"size":1553,"mtime":1611950367375,"results":"26","hashOfConfig":"16"},{"size":490,"mtime":1612172171467,"results":"27","hashOfConfig":"16"},{"size":2987,"mtime":1612215827368,"results":"28","hashOfConfig":"16"},{"size":2255,"mtime":1612215827372,"results":"29","hashOfConfig":"16"},{"filePath":"30","messages":"31","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},"1pqf0us",{"filePath":"33","messages":"34","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"35","messages":"36","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"37","messages":"38","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"39","messages":"40","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"41","messages":"42","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"43","messages":"44","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"45","messages":"46","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"47","messages":"48","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"49","messages":"50","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"51","messages":"52","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"53","messages":"54","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"55","messages":"56","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"57"},{"filePath":"58","messages":"59","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"60","usedDeprecatedRules":"32"},"C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\index.tsx",[],["61","62"],"C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\App.tsx",[],"C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\context.ts",[],"C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\test.object.assign.ts",[],"C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\ImageStream.tsx",[],"C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\Sidebar.tsx",[],"C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\model\\ImageFromFilter.ts",[],"C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\model\\Image.ts",[],"C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\GalleryInScroll.tsx",[],"C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\MyPhoto.tsx",[],"C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\my-gallery.tsx",[],"C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\widgets\\header.tsx",[],"C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\browse\\browse-page.tsx",["63"],"import { Source } from \"../App\";\nimport { useContext, useEffect, useState } from \"react\";\nimport { BarLoader } from \"react-spinners\";\nimport axios from \"redaxios\";\nimport { context } from \"../context\";\nimport CheckMD5 from \"./check-md5\";\nimport { IoReload } from \"react-icons/all\";\n\nexport default function BrowsePage(props: {\n  sources: Source[];\n  reloadSources: () => void;\n}) {\n  console.log(props.sources);\n  return (\n    <div className=\"bg-white shadow overflow-hidden sm:rounded-lg mx-3\">\n      <div className=\"px-4 py-5 flex flex-row\">\n        <h3 className=\"text-lg leading-6 font-medium text-gray-900 flex-grow\">\n          Sources\n        </h3>\n        <button\n          className=\"bg-blue-300 p-1 rounded\"\n          onClick={props.reloadSources}\n        >\n          <IoReload />\n        </button>\n      </div>\n      <div className=\"border-t border-gray-200 divide-gray-100 divide-y\">\n        {props.sources.map((el: Source) => (\n          <SourceItem data={el} key={el.id} />\n        ))}\n      </div>\n    </div>\n  );\n}\n\nfunction SourceItem(props: { data: Source }) {\n  return (\n    <div className=\"my-3 px-3 py-1 flex flex-row\">\n      <div className=\"flex-grow\">\n        <h5 className=\"\">\n          {props.data.name}\n          <span className=\"text-sm bg-blue-300 align-top px-1 mx-1\">\n            {props.data.id}\n          </span>\n        </h5>\n        <div>\n          {props.data.path} [{props.data.folders}/{props.data.files}]\n        </div>\n        <div>{props.data.md5}</div>\n      </div>\n      <CheckSource source={props.data} />\n    </div>\n  );\n}\n\ninterface CheckSourceState {\n  status: \"ok\" | \"error\";\n  error?: string;\n  files: number;\n  folders: number;\n}\n\nfunction CheckSource(props: { source: Source }) {\n  const ctx = useContext(context);\n  const [state, setState] = useState(\n    (null as unknown) as CheckSourceState | null\n  );\n  const [error, setError] = useState((null as unknown) as string);\n\n  async function fetchData() {\n    setState(null);\n    const urlCheck = new URL(\"CheckSource\", ctx.baseUrl);\n    urlCheck.searchParams.set(\"id\", props.source.id.toString());\n    try {\n      const res = await axios.get(urlCheck.toString());\n      setState(res.data);\n    } catch (e) {\n      setError(e.message);\n    }\n  }\n\n  useEffect(() => {\n    // noinspection JSIgnoredPromiseFromCall\n    fetchData();\n  }, [props.source]);\n\n  if (!state) {\n    return <BarLoader loading={true} />;\n  }\n  if (error && state?.status === \"ok\") {\n    return (\n      <button className=\"bg-red-300 p-1 rounded\" onClick={fetchData}>\n        {error} {state.error}\n      </button>\n    );\n  }\n  return (\n    <>\n      <div className=\"mx-2\">\n        <button className=\"bg-blue-300 p-1 rounded\" onClick={fetchData}>\n          OK\n        </button>\n      </div>\n      <div className=\"mx-2 w-24\">\n        <div>Files: {state.files}</div>\n        <div>Folders: {state.folders}</div>\n      </div>\n      <div className=\"mx-2\">\n        <CheckMD5 source={props.source} />\n      </div>\n    </>\n  );\n}\n","C:\\AnypointStudio\\AnypointStudio\\slawa2021\\pinacotheque\\src\\browse\\check-md5.tsx",["64","65"],"import { Source } from \"../App\";\nimport { useCallback, useContext, useEffect, useState } from \"react\";\nimport { context } from \"../context\";\nimport { BarLoader } from \"react-spinners\";\n// @ts-ignore\nimport ndjsonStream from \"can-ndjson-stream\";\n\nexport default function CheckMD5(props: { source: Source }) {\n  const ctx = useContext(context);\n  const [loading, setLoading] = useState(false);\n  const [folders, setFolders] = useState([] as string[]);\n  const [md5, setMD5] = useState(\"\");\n\n  const fetchData = useCallback(async () => {\n    setFolders([]);\n    setLoading(true);\n    const urlCheck = new URL(\"SourceScan\", ctx.baseUrl);\n    urlCheck.searchParams.set(\"id\", props.source.id.toString());\n    const res = await fetch(urlCheck.toString());\n    const exampleReader = ndjsonStream(res.body).getReader();\n\n    let result:\n      | {\n          done: boolean;\n          value?: { status: string; file: string[]; md5?: string };\n        }\n      | undefined;\n    while (!result || !result.done) {\n      result = await exampleReader.read();\n      // console.log(result);\n      if (result && result.value) {\n        // skip errors (status === 'err')\n        if (\"file\" in result.value && result.value.status === \"lines\") {\n          // @ts-ignore\n          setFolders((folders) => folders.concat(...result.value.file));\n        }\n        if (\"md5\" in result.value) {\n          setMD5(result.value.md5 ?? \"\");\n          setLoading(false);\n        }\n      }\n    }\n  }, []);\n\n  useEffect(() => {\n    // noinspection JSIgnoredPromiseFromCall\n    // fetchData();\n  }, [props.source]);\n\n  if (!folders) {\n    return <BarLoader loading={true} />;\n  }\n\n  return (\n    <div className=\"w-32\">\n      <button\n        className=\"bg-yellow-300 p-1 rounded\"\n        onClick={fetchData}\n        disabled={loading}\n      >\n        Rescan\n      </button>\n      {folders.length ? (\n        <div>\n          <div>Dir: {folders.length}</div>\n          <div>{md5}</div>\n        </div>\n      ) : null}\n      {loading && <BarLoader loading={true} />}\n      <BarLoader loading={loading} />\n    </div>\n  );\n}\n",{"ruleId":"66","replacedBy":"67"},{"ruleId":"68","replacedBy":"69"},{"ruleId":"70","severity":1,"message":"71","line":85,"column":6,"nodeType":"72","endLine":85,"endColumn":20,"suggestions":"73"},{"ruleId":"74","severity":1,"message":"75","line":35,"column":22,"nodeType":"76","messageId":"77","endLine":35,"endColumn":71},{"ruleId":"70","severity":1,"message":"78","line":43,"column":6,"nodeType":"72","endLine":43,"endColumn":8,"suggestions":"79"},"no-native-reassign",["80"],"no-negated-in-lhs",["81"],"react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'fetchData'. Either include it or remove the dependency array.","ArrayExpression",["82"],"no-loop-func","Function declared in a loop contains unsafe references to variable(s) 'result'.","ArrowFunctionExpression","unsafeRefs","React Hook useCallback has missing dependencies: 'ctx.baseUrl' and 'props.source.id'. Either include them or remove the dependency array.",["83"],"no-global-assign","no-unsafe-negation",{"desc":"84","fix":"85"},{"desc":"86","fix":"87"},"Update the dependencies array to be: [fetchData, props.source]",{"range":"88","text":"89"},"Update the dependencies array to be: [ctx.baseUrl, props.source.id]",{"range":"90","text":"91"},[2332,2346],"[fetchData, props.source]",[1466,1468],"[ctx.baseUrl, props.source.id]"]